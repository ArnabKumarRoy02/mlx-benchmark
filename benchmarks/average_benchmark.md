# Average MLX benchmark

Averaged runtime benchmark of mlx operations, measured in `milliseconds`.

* `mlx_gpu`: mlx framework with gpu backend
* `mlx_cpu`: mlx framework with cpu backend
* `cpu`: torch framework with cpu backend
* `mps`: torch framework with mps (gpu) backend
* `mlx_gpu/mps speedup`: runtime speedup of mlx_gpu compared to mps
* `mlx_gpu/mlx_cpu speedup`: runtime speedup of mlx_gpu compared to mlx_cpu
* `cuda/cpu speedup`: runtime speedup of cuda compared to cpu

## Apple Silicon

**M1 (cores: 4E+4P+8GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.81 |  10.63 |   2.87 |   8.05 |    +58% |   +486% |
| BCE        |   5.51 |  51.81 |  12.19 |  10.87 |   +121% |   +840% |
| Concat     |  19.13 | 100.88 |  19.28 |  49.63 |     +0% |   +427% |
| Conv1d     |   3.83 |   4.53 |   3.73 | 116.13 |     -2% |    +18% |
| Conv2d     |  30.12 | 436.68 |   7.06 |  45.54 |    -76% |  +1349% |
| LeakyReLU  |   2.06 |   2.90 |   1.16 |   1.37 |    -43% |    +41% |
| Linear     |  30.41 |  73.32 |  53.70 | 117.68 |    +76% |   +141% |
| MatMul     |  26.38 |  93.82 |  47.87 | 504.47 |    +81% |   +255% |
| PReLU      |   3.50 |   4.54 |   1.15 |   1.32 |    -67% |    +29% |
| ReLU       |   0.98 |   0.90 |   1.13 |   1.35 |    +14% |     -8% |
| SeLU       |   7.81 |  14.73 |   1.14 |   7.72 |    -85% |    +88% |
| Sigmoid    |   0.96 |  32.66 |   1.16 |   7.23 |    +19% |  +3287% |
| Softmax    |  10.15 |  40.98 |  19.27 |  46.69 |    +89% |   +303% |
| Softplus   |   1.07 |  33.08 |   1.73 |  10.99 |    +60% |  +2977% |
| Sort       |  18.49 | 713.23 |  73.24 |  70.11 |   +296% |  +3756% |
| Sum        |  11.33 |  12.70 |  16.35 |  13.43 |    +44% |    +12% |
| SumAll     |   6.91 |   6.85 |   7.40 |   7.00 |     +7% |      0% |

**M1 Pro**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.32 |  13.97 |   1.92 |   8.30 |    +45% |   +957% |
| BCE        |   4.18 |  28.57 |   8.98 |   8.50 |   +114% |   +583% |
| Concat     |   6.51 | 103.22 |   7.14 |  42.93 |     +9% |  +1485% |
| Conv1d     |   3.74 |   3.58 |   2.53 | 152.46 |    -32% |     -4% |
| Conv2d     |  14.79 | 444.64 |   5.05 |  44.68 |    -65% |  +2905% |
| LeakyReLU  |   0.88 |   2.07 |   0.79 |   1.09 |    -10% |   +134% |
| Linear     |  14.77 |  50.73 |  33.53 | 102.24 |   +127% |   +243% |
| MatMul     |  15.59 |  52.57 |  27.29 | 560.23 |    +75% |   +237% |
| PReLU      |   1.42 |   3.46 |   0.79 |   1.46 |    -44% |   +143% |
| ReLU       |   0.54 |   0.72 |   0.73 |   1.29 |    +34% |    +32% |
| SeLU       |   3.11 |  12.86 |   0.73 |   6.67 |    -76% |   +313% |
| Sigmoid    |   0.60 |  32.43 |   0.82 |   6.17 |    +36% |  +5309% |
| Softmax    |   4.00 |  40.28 |  10.90 |  36.93 |   +172% |   +906% |
| Softplus   |   0.77 |  32.68 |   1.16 |   8.79 |    +51% |  +4159% |
| Sort       |   9.53 | 838.22 |  37.53 |  54.08 |   +293% |  +8694% |
| Sum        |   5.76 |  12.76 |   6.38 |  10.80 |    +10% |   +121% |
| SumAll     |   2.62 |   6.75 |   2.87 |   3.43 |     +9% |   +157% |

**M2**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.71 |  16.21 |   2.71 |   8.51 |    +58% |   +849% |
| BCE        |   3.71 |  82.34 |  13.06 |  13.34 |   +251% |  +2118% |
| Concat     |  12.14 | 161.07 |  12.51 |  46.33 |     +3% |  +1226% |
| Conv1d     |   3.66 |   6.01 |   3.29 | 132.69 |    -10% |    +64% |
| Conv2d     |  27.74 | 705.78 |   5.94 |  56.88 |    -78% |  +2444% |
| LeakyReLU  |   1.50 |   2.44 |   1.10 |   1.33 |    -26% |    +62% |
| Linear     |  25.01 |  99.71 |  57.29 | 183.02 |   +129% |   +298% |
| MatMul     |  22.04 | 120.61 |  78.10 | 629.63 |   +254% |   +447% |
| PReLU      |   2.43 |   4.58 |   1.04 |   1.35 |    -57% |    +88% |
| ReLU       |   0.77 |   1.00 |   1.00 |   1.34 |    +30% |    +29% |
| SeLU       |   5.31 |  17.25 |   1.11 |   8.24 |    -79% |   +224% |
| Sigmoid    |   0.77 |  52.85 |   1.13 |   7.47 |    +47% |  +6797% |
| Softmax    |   7.07 |  65.62 |  14.54 |  60.92 |   +105% |   +828% |
| Softplus   |   0.91 |  53.94 |   1.73 |  12.12 |    +90% |  +5846% |
| Sort       |  16.87 | 1243.25 |  46.69 |  79.31 |   +176% |  +7269% |
| Sum        |   9.15 |  18.38 |  10.47 |  14.19 |    +14% |   +100% |
| SumAll     |   4.31 |   7.79 |   4.96 |   6.11 |    +14% |    +80% |

**M2 Pro (cores: 4E+6P+16GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   1.10 |  11.84 |   1.47 |   7.78 |    +34% |   +979% |
| BCE        |   2.08 |  47.55 |   7.99 |   7.79 |   +284% |  +2188% |
| Concat     |   6.13 |  92.60 |   6.44 |  39.02 |     +5% |  +1411% |
| Conv1d     |   2.87 |   3.30 |   1.98 | 145.07 |    -30% |    +15% |
| Conv2d     |  14.31 | 401.42 |   4.55 |  43.57 |    -68% |  +2704% |
| LeakyReLU  |   1.01 |   1.95 |   1.01 |   1.22 |      0% |    +93% |
| Linear     |  12.73 |  45.55 |  31.81 | 103.01 |   +149% |   +257% |
| MatMul     |  14.69 |  43.34 |  22.79 | 785.05 |    +55% |   +195% |
| PReLU      |   1.37 |   3.42 |   0.87 |   1.23 |    -35% |   +150% |
| ReLU       |   0.48 |   0.71 |   0.92 |   1.15 |    +89% |    +45% |
| SeLU       |   2.78 |  12.23 |   1.00 |   5.66 |    -63% |   +339% |
| Sigmoid    |   0.79 |  30.60 |   1.09 |   5.23 |    +38% |  +3778% |
| Softmax    |   3.91 |  38.92 |   9.17 |  36.03 |   +134% |   +895% |
| Softplus   |   0.85 |  31.50 |   1.13 |   7.81 |    +32% |  +3588% |
| Sort       |   8.50 | 709.04 |  23.19 |  48.95 |   +173% |  +8245% |
| Sum        |   4.05 |  11.55 |   4.27 |  10.36 |     +5% |   +184% |
| SumAll     |   2.55 |   6.60 |   2.85 |   3.47 |    +11% |   +158% |

**M2 Max (cores: 4E+8P+38GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   0.87 |  11.47 |   1.29 |   7.27 |    +47% |  +1213% |
| BCE        |   1.31 |  46.26 |   6.81 |   6.27 |   +417% |  +3420% |
| Concat     |   3.19 |  90.31 |   3.87 |  23.54 |    +21% |  +2728% |
| Conv1d     |   3.88 |   3.24 |   1.49 | 147.63 |    -61% |    -16% |
| Conv2d     |   6.88 | 391.73 |   2.39 |  36.21 |    -65% |  +5595% |
| LeakyReLU  |   0.89 |   1.78 |   0.94 |   0.86 |     +5% |    +99% |
| Linear     |   6.33 |  45.43 |  13.66 |  75.38 |   +115% |   +618% |
| MatMul     |  10.35 |  42.33 |  10.73 | 713.08 |     +3% |   +309% |
| PReLU      |   1.24 |   3.15 |   0.98 |   0.88 |    -21% |   +154% |
| ReLU       |   0.71 |   0.76 |   0.94 |   0.94 |    +32% |     +7% |
| SeLU       |   1.91 |  12.00 |   1.00 |   4.51 |    -47% |   +528% |
| Sigmoid    |   0.47 |  31.06 |   0.74 |   4.46 |    +57% |  +6469% |
| Softmax    |   2.39 |  38.44 |   6.81 |  23.90 |   +184% |  +1506% |
| Softplus   |   0.43 |  31.37 |   0.83 |   6.31 |    +91% |  +7129% |
| Sort       |   3.75 | 699.20 |  10.99 |  41.23 |   +193% | +18550% |
| Sum        |   2.09 |  11.55 |   2.60 |  10.40 |    +24% |   +453% |
| SumAll     |   1.41 |   6.60 |   1.94 |   3.48 |    +38% |   +369% |

**M2 Ultra (cores: 8E+16P+76GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   0.64 |  14.77 |   0.70 |   9.62 |    +10% |  +2223% |
| BCE        |   0.80 |  47.48 |   3.48 |   3.72 |   +335% |  +5849% |
| Concat     |   1.73 |  97.44 |   1.88 |  34.95 |     +8% |  +5546% |
| Conv1d     |   3.20 |   3.09 |   0.72 | 171.48 |    -77% |     -3% |
| Conv2d     |   4.13 | 381.61 |   0.99 |  39.39 |    -75% |  +9144% |
| LeakyReLU  |   0.45 |   2.16 |   0.54 |   1.49 |    +19% |   +379% |
| Linear     |   3.14 |  40.16 |   7.50 |  66.90 |   +138% |  +1179% |
| MatMul     |   9.96 |  36.01 |   6.38 | 1808.76 |    -35% |   +261% |
| PReLU      |   0.53 |   3.85 |   0.53 |   1.40 |     +1% |   +630% |
| ReLU       |   0.34 |   0.98 |   0.52 |   1.15 |    +53% |   +191% |
| SeLU       |   1.03 |  13.49 |   0.46 |   2.99 |    -55% |  +1208% |
| Sigmoid    |   0.35 |  29.52 |   0.48 |   2.75 |    +36% |  +8298% |
| Softmax    |   1.51 |  37.31 |   3.72 |  14.72 |   +146% |  +2367% |
| Softplus   |   0.36 |  30.14 |   0.56 |   3.79 |    +55% |  +8201% |
| Sort       |   2.13 | 672.68 |   7.02 |  21.38 |   +230% | +31521% |
| Sum        |   1.22 |  11.49 |   1.36 |   6.69 |    +11% |   +845% |
| SumAll     |   0.81 |   7.00 |   1.00 |   2.14 |    +24% |   +766% |

**M3 Max (cores: 4E+12P+40GPU)**

| Operation      | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|----------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax     |   0.47 |  12.02 |   1.23 |   6.19 |   +162% |  +2464% |
| BCE        |   1.15 |  37.79 |   4.14 |   3.79 |   +261% |  +3196% |
| Concat     |   3.38 |  77.89 |   3.59 |  23.25 |     +6% |  +2203% |
| Conv1d     |   0.97 |   2.52 |   1.31 | 157.28 |    +35% |   +159% |
| Conv2d     |   4.32 | 329.00 |   1.98 |  30.54 |    -54% |  +7507% |
| LeakyReLU  |   0.56 |   1.17 |   0.71 |   0.55 |    +27% |   +110% |
| Linear     |   5.91 |  38.62 |   4.78 |  58.90 |    -19% |   +553% |
| MatMul     |  10.68 |  42.18 |   8.31 | 784.09 |    -22% |   +295% |
| PReLU      |   0.79 |   2.03 |   0.58 |   0.84 |    -26% |   +156% |
| ReLU       |   0.48 |   0.53 |   0.70 |   0.72 |    +44% |    +10% |
| SeLU       |   1.58 |   9.08 |   0.69 |   3.27 |    -56% |   +474% |
| Sigmoid    |   0.40 |  27.03 |   0.64 |   3.09 |    +59% |  +6589% |
| Softmax    |   2.48 |  32.96 |   6.05 |  17.32 |   +144% |  +1231% |
| Softplus   |   0.39 |  26.65 |   0.74 |   4.76 |    +89% |  +6713% |
| Sort       |   3.17 | 752.79 |   8.62 |  33.14 |   +172% | +23652% |
| Sum        |   2.07 |   9.96 |   2.55 |   7.55 |    +23% |   +381% |
| SumAll     |   1.41 |   4.92 |   2.00 |   3.24 |    +42% |   +249% |


## CUDA GPUs

**Tesla V100 32Go (NVLink) / Intel Xeon Gold 6148 20 cores, 40 threads @ 2.4 GHz (Skylake), 60Go**

| Operation      | cpu | cuda | cuda/cpu speedup |
|----------------|------|------|----------------|
| Argmax     |  24.91 |   0.05 | +49850% |
| BCE        | 142.61 | 139.81 |     +2% |
| Concat     | 151.85 |   0.04 | +364265% |
| Conv1d     |  14.39 |   0.14 | +10396% |
| Conv2d     |  22.58 |   0.08 | +27420% |
| LeakyReLU  |   5.30 |   0.05 |  +9966% |
| Linear     | 280.73 |   0.12 | +238950% |
| MatMul     | 320.23 |   0.08 | +420113% |
| PReLU      |   5.37 |   0.04 | +13020% |
| ReLU       |   5.39 |   0.05 | +11126% |
| SeLU       |   9.05 |   0.06 | +15982% |
| Sigmoid    |   7.62 |   0.06 | +13154% |
| Softmax    |  89.80 |   0.04 | +223686% |
| Softplus   |  16.37 |   0.05 | +34238% |
| Sort       | 384.81 |   0.09 | +426581% |
| Sum        |  66.76 |   0.05 | +142329% |
| SumAll     |  29.81 |   0.05 | +63602% |

**Tesla V100 32Go (PCIe) / Intel Xeon Gold 5120 14 cores / 28 threads @ 2.2GHz (Skylake), 60Go**

| Operation      | cpu | cuda | cuda/cpu speedup |
|----------------|------|------|----------------|
| Argmax     |  28.51 |   0.05 | +54937% |
| BCE        | 162.93 | 162.93 |     +0% |
| Concat     | 153.20 |   0.05 | +296766% |
| Conv1d     |  19.83 |   0.16 | +12492% |
| Conv2d     |  31.96 |   0.10 | +31380% |
| LeakyReLU  |   5.37 |   0.06 |  +8844% |
| Linear     | 488.32 |   0.13 | +368993% |
| MatMul     | 476.94 |   0.09 | +557853% |
| PReLU      |   5.51 |   0.05 | +11436% |
| ReLU       |   5.73 |   0.05 | +11151% |
| SeLU       |   9.60 |   0.07 | +13760% |
| Sigmoid    |   8.10 |   0.06 | +14465% |
| Softmax    |  97.01 |   0.04 | +228312% |
| Softplus   |  16.94 |   0.06 | +30331% |
| Sort       | 439.61 |   0.12 | +363723% |
| Sum        |  63.83 |   0.05 | +123983% |
| SumAll     |  27.92 |   0.05 | +52778% |
