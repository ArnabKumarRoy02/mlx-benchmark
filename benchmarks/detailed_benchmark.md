# Detailed MLX benchmark

Detailed runtime benchmark of mlx operations, measured in `milliseconds`.

* `mlx_gpu`: mlx framework with gpu backend
* `mlx_cpu`: mlx framework with cpu backend
* `cpu`: torch framework with cpu backend
* `mps`: torch framework with mps (gpu) backend
* `mps/mlx_gpu speedup`: runtime speedup of mlx_gpu compared to mps
* `mlx_cpu/mlx_gpu speedup`: runtime speedup of mlx_gpu compared to mlx_cpu

## Apple Silicon

**M1 Pro**

| Operation                                           | mlx_gpu | mlx_cpu | mps | cpu | mps/mlx_gpu speedup | mlx_cpu/mlx_gpu speedup |
|-----------------------------------------------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax / dim=64x1024x128 axi=0                  |   2.01 |  26.50 |   2.37 |  23.74 |   0.15 |   0.92 |
| Argmax / dim=64x1024x128 axi=1                  |   1.44 |  11.09 |   3.17 |   5.26 |   0.55 |   0.87 |
| Argmax / dim=64x1024x128 axi=2                  |   1.02 |   8.60 |   1.57 |   2.16 |   0.35 |   0.88 |
| Argmax / dim=64x128x1024 axi=2                  |   1.01 |  10.29 |   1.02 |   2.01 |   0.02 |   0.90 |
| BCE / dim=1000000 dim=1000000                   |   1.06 |   5.09 |   1.38 |   1.31 |   0.23 |   0.79 |
| BCE / dim=100000x32 dim=100000x32               |   2.12 |  13.07 |   3.90 |   3.47 |   0.46 |   0.84 |
| BCE / dim=100000x64x2 dim=100000x64x2           |   6.80 |  47.94 |  16.21 |  14.59 |   0.58 |   0.86 |
| BCE / dim=128x100000 dim=128x100000             |   7.03 |  47.83 |  14.95 |  14.45 |   0.53 |   0.85 |
| Concat / dim=1000000x64 dim=1000000x32 axi=1    |   4.48 |  65.71 |   4.81 |  31.00 |   0.07 |   0.93 |
| Concat / dim=1000000x64 dim=1000000x128 axi=1   |   8.59 | 153.78 |  10.28 |  51.13 |   0.16 |   0.94 |
| Concat / dim=1000000x64 dim=1000000x64 axi=0    |   5.84 |  84.95 |   6.05 |  41.54 |   0.03 |   0.93 |
| Concat / dim=64x1000000 dim=64x1000000 axi=0    |   5.88 | 103.66 |   6.18 |  41.50 |   0.05 |   0.94 |
| Conv1d / dim=100x256x3 dim=8x3x3                |   0.52 |   0.38 |   0.60 |   2.76 |   0.13 |  -0.38 |
| Conv1d / dim=100x256x256 dim=8x3x256            |   3.20 |   8.55 |   3.69 |  73.08 |   0.13 |   0.63 |
| Conv1d / dim=16x1000x80 dim=128x11x80           |   7.39 |   4.73 |   4.52 | 480.79 |  -0.63 |  -0.56 |
| Conv1d / dim=16x1000x3 dim=128x11x3             |   5.63 |   0.69 |   1.18 |  58.02 |  -3.76 |  -7.11 |
| Conv2d / dim=100x256x256x3 dim=8x3x3x3          |  36.32 | 975.06 |  10.49 | 144.42 |  -2.46 |   0.96 |
| Conv2d / dim=100x256x256x12 dim=8x3x3x12        | 136.29 | 4175.96 |  21.41 | 273.34 |  -5.36 |   0.97 |
| Conv2d / dim=10x256x256x128 dim=8x3x3x128       | 140.30 | 7052.94 |  20.51 | 206.10 |  -5.84 |   0.98 |
| Conv2d / dim=100x28x28x3 dim=8x3x3x3            |   1.42 |  11.00 |   0.91 |   1.48 |  -0.56 |   0.87 |
| Conv2d / dim=1000x28x28x3 dim=8x3x3x3           |   6.55 | 111.63 |   2.70 |   8.43 |  -1.42 |   0.94 |
| LeakyReLU / dim=128x16x1024                     |   0.53 |   1.12 |   0.51 |   1.08 |  -0.05 |   0.53 |
| LeakyReLU / dim=64x128x1024                     |   1.44 |   2.95 |   0.97 |   1.46 |  -0.48 |   0.51 |
| Linear / dim=100x1024x32 dim=32x1024 dim=1024   |  11.18 |  47.06 |  10.35 |  44.71 |  -0.08 |   0.76 |
| Linear / dim=100x1024x64 dim=64x1024 dim=1024   |  11.74 |  54.01 |  13.23 |  59.51 |   0.11 |   0.78 |
| Linear / dim=100x1024x256 dim=256x1024 dim=1024 |  17.98 |  65.47 |  48.28 | 142.99 |   0.63 |   0.73 |
| Linear / dim=100x1024x512 dim=512x1024 dim=1024 |  30.53 |  89.12 |  94.92 | 252.22 |   0.68 |   0.66 |
| Linear / dim=100x1x51200 dim=51200x1 dim=1      |   0.79 |   0.39 |   0.92 |   0.94 |   0.14 |  -1.01 |
| MatMul / dim=32x1x1000 dim=32x1000x128          |   0.40 |   0.87 |   0.72 |   0.81 |   0.45 |   0.55 |
| MatMul / dim=1000x64x256 dim=256x32             |   0.72 |   1.98 |   5.00 |  26.00 |   0.86 |   0.64 |
| MatMul / dim=1000x64x1024 dim=1000x1024x32      |   2.68 |  18.27 |  13.94 | 374.00 |   0.81 |   0.85 |
| MatMul / dim=1000x1024x64 dim=1000x64x256       |   9.94 |  88.66 |  15.22 | 1546.69 |   0.35 |   0.89 |
| MatMul / dim=64x1000000 dim=1000000x32          |  42.16 |  11.00 |  19.99 | 188.41 |  -1.11 |  -2.83 |
| MatMul / dim=1000000x64 dim=64x1024             |  37.47 | 190.23 | 102.18 | 1567.76 |   0.63 |   0.80 |
| PReLU / dim=128x16x1024 dim=1                   |   0.80 |   1.97 |   0.54 |   1.16 |  -0.47 |   0.59 |
| PReLU / dim=64x128x1024 dim=1                   |   1.96 |   4.74 |   0.92 |   1.49 |  -1.13 |   0.59 |
| ReLU / dim=128x16x1024                          |   0.40 |   0.45 |   0.48 |   0.80 |   0.15 |   0.11 |
| ReLU / dim=64x128x1024                          |   0.69 |   0.98 |   0.95 |   1.47 |   0.27 |   0.29 |
| SeLU / dim=128x16x1024                          |   1.48 |   5.89 |   0.51 |   2.72 |  -1.88 |   0.75 |
| SeLU / dim=64x128x1024                          |   4.32 |  19.75 |   1.00 |  10.51 |  -3.34 |   0.78 |
| Sigmoid / dim=128x16x1024                       |   0.41 |  12.95 |   0.52 |   2.47 |   0.21 |   0.97 |
| Sigmoid / dim=64x128x1024                       |   0.66 |  51.13 |   1.03 |   9.75 |   0.36 |   0.99 |
| Softmax / dim=64x1000000 axi=-1                 |   4.57 |  34.76 |   6.34 |  41.60 |   0.28 |   0.87 |
| Softmax / dim=1000000x64 axi=-1                 |   3.73 |  33.65 |  11.79 |  45.99 |   0.68 |   0.89 |
| Softmax / dim=64x16x32x1024 axi=-1              |   1.83 |  17.94 |   9.83 |  20.60 |   0.81 |   0.90 |
| Softmax / dim=128x16x32x1024 axi=-1             |   3.20 |  35.22 |  18.57 |  41.77 |   0.83 |   0.91 |
| Softmax / dim=1024x16x32x128 axi=-1             |   3.23 |  34.34 |  12.26 |  44.31 |   0.74 |   0.91 |
| Softmax / dim=1024x64x32x8 axi=-1               |   7.46 |  85.17 |   4.59 |  22.52 |  -0.62 |   0.91 |
| Softplus / dim=128x16x1024                      |   0.66 |  13.10 |   0.69 |   3.73 |   0.05 |   0.95 |
| Softplus / dim=64x128x1024                      |   1.15 |  51.29 |   1.61 |  14.00 |   0.29 |   0.98 |
| Sort / dim=64x128x1024 axi=0                    |  17.07 | 1297.81 |  50.50 |  56.03 |   0.66 |   0.99 |
| Sort / dim=64x128x1024 axi=1                    |   9.18 | 966.16 |  44.92 |  47.49 |   0.80 |   0.99 |
| Sort / dim=64x128x1024 axi=2                    |   2.16 | 255.87 |  17.26 |  60.20 |   0.87 |   0.99 |
| Sum / dim=64x128x128x128 axi=0                  |  10.73 |  17.61 |  12.32 |  14.79 |   0.13 |   0.39 |
| Sum / dim=64x128x128x128 axi=1                  |   3.43 |  12.39 |   3.56 |  14.19 |   0.04 |   0.72 |
| Sum / dim=64x128x128x128 axi=2                  |   3.32 |  10.91 |   3.45 |   8.18 |   0.04 |   0.70 |
| Sum / dim=64x128x128x128 axi=3                  |   5.47 |   9.31 |   6.26 |   5.54 |   0.13 |   0.41 |
| SumAll / dim=64x128x128x128                     |   3.59 |   9.85 |   3.63 |   4.91 |   0.01 |   0.64 |
| SumAll / dim=1000000                            |   0.41 |   0.08 |   0.48 |   0.12 |   0.13 |  -4.07 |
| SumAll / dim=1000000x128                        |   3.32 |   8.61 |   3.52 |   4.48 |   0.06 |   0.61 |
| SumAll / dim=128x1000000                        |   3.32 |   8.61 |   3.51 |   4.44 |   0.06 |   0.61 |