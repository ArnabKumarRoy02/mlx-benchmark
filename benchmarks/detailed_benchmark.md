# Detailed MLX benchmark

Detailed runtime benchmark of mlx operations, measured in `milliseconds`.

* `mlx_gpu`: mlx framework with gpu backend
* `mlx_cpu`: mlx framework with cpu backend
* `cpu`: torch framework with cpu backend
* `mps`: torch framework with mps (gpu) backend
* `mlx_gpu/mps speedup`: runtime speedup of mlx_gpu compared to mps
* `mlx_gpu/mlx_cpu speedup`: runtime speedup of mlx_gpu compared to mlx_cpu

## Apple Silicon

**M1 Pro**

| Operation                                           | mlx_gpu | mlx_cpu | mps | cpu | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|-----------------------------------------------------|-------|-------|------|------|-------------------|-----------------------|
| Argmax / dim=64x1024x128 axi=0                  |   1.77 |  26.02 |   2.36 |  23.67 |    +33% |  +1366% |
| Argmax / dim=64x1024x128 axi=1                  |   1.46 |  10.94 |   2.54 |   5.42 |    +74% |   +650% |
| Argmax / dim=64x1024x128 axi=2                  |   1.07 |   8.53 |   1.76 |   2.08 |    +64% |   +696% |
| Argmax / dim=64x128x1024 axi=2                  |   0.98 |  10.41 |   1.02 |   2.03 |     +3% |   +960% |
| BCE / dim=1000000 dim=1000000                   |   1.04 |   5.04 |   1.32 |   1.38 |    +27% |   +384% |
| BCE / dim=100000x32 dim=100000x32               |   2.08 |  13.13 |   4.12 |   3.46 |    +97% |   +531% |
| BCE / dim=100000x64x2 dim=100000x64x2           |   6.84 |  48.06 |  15.80 |  14.44 |   +131% |   +602% |
| BCE / dim=128x100000 dim=128x100000             |   6.75 |  48.04 |  14.67 |  14.70 |   +117% |   +611% |
| Concat / dim=1000000x64 dim=1000000x32 axi=1    |   4.48 |  65.46 |   5.15 |  38.61 |    +14% |  +1361% |
| Concat / dim=1000000x64 dim=1000000x128 axi=1   |   9.49 | 146.11 |  11.10 |  46.41 |    +16% |  +1439% |
| Concat / dim=1000000x64 dim=1000000x64 axi=0    |   6.12 |  86.09 |   6.14 |  44.37 |     +0% |  +1306% |
| Concat / dim=64x1000000 dim=64x1000000 axi=0    |   5.96 | 115.23 |   6.18 |  42.34 |     +3% |  +1832% |
| Conv1d / dim=100x256x3 dim=8x3x3                |   0.55 |   0.43 |   0.60 |   2.83 |     +8% |    -22% |
| Conv1d / dim=100x256x256 dim=8x3x256            |   3.08 |   8.39 |   3.96 |  70.79 |    +28% |   +172% |
| Conv1d / dim=16x1000x80 dim=128x11x80           |   7.02 |   4.80 |   4.36 | 479.63 |    -37% |    -31% |
| Conv1d / dim=16x1000x3 dim=128x11x3             |   4.29 |   0.71 |   1.21 |  56.60 |    -71% |    -83% |
| Conv2d / dim=100x256x256x3 dim=8x3x3x3          |  38.20 | 970.11 |   9.33 | 145.74 |    -75% |  +2439% |
| Conv2d / dim=10x256x256x12 dim=8x3x3x12         |  14.37 | 418.11 |   5.71 |  26.47 |    -60% |  +2810% |
| Conv2d / dim=1x256x256x128 dim=8x3x3x128        |  13.48 | 711.52 |   6.22 |  39.74 |    -53% |  +5179% |
| Conv2d / dim=100x28x28x3 dim=8x3x3x3            |   1.46 |  11.15 |   0.99 |   1.54 |    -32% |   +663% |
| Conv2d / dim=1000x28x28x3 dim=8x3x3x3           |   6.47 | 112.32 |   3.02 |   9.89 |    -53% |  +1636% |
| LeakyReLU / dim=128x16x1024                     |   0.51 |   1.14 |   0.62 |   0.72 |    +21% |   +122% |
| LeakyReLU / dim=64x128x1024                     |   1.25 |   3.00 |   0.96 |   1.47 |    -23% |   +139% |
| Linear / dim=100x1024x32 dim=32x1024 dim=1024   |  11.25 |  46.65 |  10.03 |  48.68 |    -10% |   +314% |
| Linear / dim=100x1024x64 dim=64x1024 dim=1024   |  13.14 |  51.24 |  13.12 |  63.80 |      0% |   +290% |
| Linear / dim=100x1024x256 dim=256x1024 dim=1024 |  18.10 |  65.19 |  48.56 | 145.58 |   +168% |   +260% |
| Linear / dim=100x1024x512 dim=512x1024 dim=1024 |  30.52 |  90.13 |  95.09 | 252.15 |   +211% |   +195% |
| Linear / dim=100x1x51200 dim=51200x1 dim=1      |   0.82 |   0.43 |   0.86 |   0.97 |     +5% |    -47% |
| MatMul / dim=32x1x1000 dim=32x1000x128          |   0.44 |   0.87 |   0.68 |   0.81 |    +52% |    +96% |
| MatMul / dim=1000x64x256 dim=256x32             |   0.74 |   2.10 |   5.13 |  21.98 |   +590% |   +182% |
| MatMul / dim=1000x64x1024 dim=1000x1024x32      |   2.86 |  18.48 |  13.91 | 340.08 |   +386% |   +545% |
| MatMul / dim=1000x1024x64 dim=1000x64x256       |   9.98 |  92.40 |  13.77 | 1052.02 |    +37% |   +826% |
| MatMul / dim=64x1000000 dim=1000000x32          |  42.21 |  10.81 |  19.93 | 214.15 |    -52% |    -74% |
| MatMul / dim=1000000x64 dim=64x1024             |  37.30 | 190.73 | 110.35 | 1732.31 |   +195% |   +411% |
| PReLU / dim=128x16x1024 dim=1                   |   0.82 |   1.99 |   0.54 |   0.89 |    -33% |   +143% |
| PReLU / dim=64x128x1024 dim=1                   |   2.02 |   4.93 |   1.03 |   2.03 |    -48% |   +143% |
| ReLU / dim=128x16x1024                          |   0.41 |   0.47 |   0.51 |   1.12 |    +25% |    +16% |
| ReLU / dim=64x128x1024                          |   0.68 |   0.96 |   0.95 |   1.46 |    +39% |    +42% |
| SeLU / dim=128x16x1024                          |   1.78 |   5.97 |   0.50 |   2.63 |    -71% |   +234% |
| SeLU / dim=64x128x1024                          |   4.44 |  19.75 |   0.96 |  10.72 |    -78% |   +344% |
| Sigmoid / dim=128x16x1024                       |   0.49 |  12.99 |   0.57 |   2.42 |    +15% |  +2539% |
| Sigmoid / dim=64x128x1024                       |   0.71 |  51.87 |   1.07 |   9.92 |    +51% |  +7237% |
| Softmax / dim=64x1000000 axi=-1                 |   4.58 |  34.96 |   6.44 |  43.40 |    +40% |   +663% |
| Softmax / dim=1000000x64 axi=-1                 |   3.75 |  33.74 |  11.37 |  45.84 |   +203% |   +799% |
| Softmax / dim=64x16x32x1024 axi=-1              |   1.78 |  17.67 |  11.14 |  19.28 |   +525% |   +891% |
| Softmax / dim=128x16x32x1024 axi=-1             |   3.23 |  35.84 |  18.36 |  43.99 |   +469% |  +1010% |
| Softmax / dim=1024x16x32x128 axi=-1             |   3.21 |  34.29 |  13.50 |  46.44 |   +320% |   +968% |
| Softmax / dim=1024x64x32x8 axi=-1               |   7.46 |  85.17 |   4.58 |  22.62 |    -38% |  +1041% |
| Softplus / dim=128x16x1024                      |   0.61 |  13.17 |   0.72 |   3.78 |    +18% |  +2074% |
| Softplus / dim=64x128x1024                      |   0.93 |  52.19 |   1.60 |  13.81 |    +72% |  +5518% |
| Sort / dim=64x128x1024 axi=0                    |  17.20 | 1290.42 |  50.49 |  56.62 |   +193% |  +7401% |
| Sort / dim=64x128x1024 axi=1                    |   9.16 | 968.59 |  44.94 |  48.71 |   +390% | +10479% |
| Sort / dim=64x128x1024 axi=2                    |   2.24 | 255.63 |  17.18 |  56.91 |   +668% | +11333% |
| Sum / dim=64x128x128x128 axi=0                  |  10.77 |  17.78 |  12.25 |  14.67 |    +13% |    +65% |
| Sum / dim=64x128x128x128 axi=1                  |   3.43 |  12.44 |   3.55 |  14.60 |     +3% |   +262% |
| Sum / dim=64x128x128x128 axi=2                  |   3.31 |  11.23 |   3.51 |   8.31 |     +5% |   +238% |
| Sum / dim=64x128x128x128 axi=3                  |   5.51 |   9.59 |   6.20 |   5.61 |    +12% |    +74% |
| SumAll / dim=64x128x128x128                     |   3.51 |   9.10 |   3.53 |   4.71 |     +0% |   +159% |
| SumAll / dim=1000000                            |   0.35 |   0.08 |   0.48 |   0.12 |    +36% |    -76% |
| SumAll / dim=1000000x128                        |   3.32 |   9.23 |   3.59 |   4.43 |     +8% |   +177% |
| SumAll / dim=128x1000000                        |   3.32 |   8.59 |   3.89 |   4.45 |    +17% |   +158% |